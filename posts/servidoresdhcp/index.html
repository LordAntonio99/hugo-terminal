<!doctype html><html lang=en>
<head>
<title>Servidores DHCP Teoría :: La web de Antonio</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Teoría completa del examen de DHCP para Servicios y Redes">
<meta name=keywords content=",">
<meta name=robots content="noodp">
<link rel=canonical href=https://lordantonio99.github.io/hugo-terminal/posts/servidoresdhcp/>
<link rel=stylesheet href=https://lordantonio99.github.io/hugo-terminal/assets/style.css>
<link rel=stylesheet href=https://lordantonio99.github.io/hugo-terminal/assets/pink.css>
<link rel=apple-touch-icon href=https://lordantonio99.github.io/hugo-terminal/img/apple-touch-icon-192x192.png>
<link rel="shortcut icon" href=https://lordantonio99.github.io/hugo-terminal/img/favicon/pink.png>
<meta name=twitter:card content="summary">
<meta name=twitter:site content>
<meta name=twitter:creator content>
<meta property="og:locale" content="en">
<meta property="og:type" content="article">
<meta property="og:title" content="Servidores DHCP Teoría">
<meta property="og:description" content="Teoría completa del examen de DHCP para Servicios y Redes">
<meta property="og:url" content="https://lordantonio99.github.io/hugo-terminal/posts/servidoresdhcp/">
<meta property="og:site_name" content="La web de Antonio">
<meta property="og:image" content="https://lordantonio99.github.io/hugo-terminal/img/dhcp.png">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">
<meta property="article:published_time" content="2022-02-03 13:43:56 +0100 +0100">
</head>
<body class=pink>
<div class="container full headings--one-size">
<header class=header>
<div class=header__inner>
<div class=header__logo>
<a href=https://lordantonio99.github.io/hugo-terminal/>
<div class=logo>
Antonio
</div>
</a>
</div>
<div class=menu-trigger>menu</div>
</div>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=https://lordantonio99.github.io/hugo-terminal/about>About</a></li>
<li><a href=https://lordantonio99.github.io/hugo-terminal/showcase>Showcase</a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=https://lordantonio99.github.io/hugo-terminal/about>About</a></li>
<li><a href=https://lordantonio99.github.io/hugo-terminal/showcase>Showcase</a></li>
</ul>
</nav>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>
<a href=https://lordantonio99.github.io/hugo-terminal/posts/servidoresdhcp/>Servidores DHCP Teoría</a></h1>
<div class=post-meta>
<span class=post-date>
2022-02-03
</span>
<span class=post-reading-time>:: 7 min read (1409 words)</span>
</div>
<span class=post-tags>
#<a href=https://lordantonio99.github.io/hugo-terminal/tags/redes/>redes</a>&nbsp;
#<a href=https://lordantonio99.github.io/hugo-terminal/tags/dhcp/>dhcp</a>&nbsp;
</span>
<img src=https://lordantonio99.github.io/hugo-terminal/img/dhcp.png class=post-cover alt="Servidores DHCP Teoría" title="Cover Image">
<div class=post-content><div>
<h1 id=servidores-dhcp>Servidores DHCP<a href=#servidores-dhcp class=hanchor arialabel=Anchor>&#8983;</a> </h1>
<h2 id=introducción>Introducción<a href=#introducción class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>DHCP es un protocolo de configuración dinámica de hosts, con el que asignamos Ips dentro de un rango que establecemos.</p>
<p>Su principal función es que los dispositivos de una red obtengan su configuración de internet de forma automática.</p>
<p>Los hosts que proporcionan servicios de red no deberían usar esta configuración, ya que dependen de ella y pueden desconectarse o causar errores.</p>
<h2 id=componentes-de-un-servidor-dhcp>Componentes de un servidor DHCP<a href=#componentes-de-un-servidor-dhcp class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>Sus componentes son:</p>
<ul>
<li>
<p>Servidor DHCP: asigna la configuración a los clientes.</p>
</li>
<li>
<p>Clientes DHCP: realizan las peticiones al servidor y configuran sus parámetros con los que el servidor les devuelve.</p>
</li>
<li>
<p>Protocolo DHCP: conjunto de normas y reglas de diálogo entre el servidor y el cliente.</p>
</li>
<li>
<p>Agentes de retransmisión DHCP: escuchan las peticiones de los clientes y las retransmiten a los servidores.</p>
</li>
</ul>
<h2 id=tipos-de-asignación>Tipos de asignación<a href=#tipos-de-asignación class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>Dentro de la asignación de Ips de DHCP, podemos configurar diferentes tipos:</p>
<ul>
<li>
<p>Manual o estática: se trata de direcciones concretas para máquinas las cuales van a obtener siempre la misma configuración, puesto que estarán reservadas.</p>
</li>
<li>
<p>Dinámica: asigna una Ip aleatoria dentro del rango durante un tiempo establecido (lease time)</p>
</li>
<li>
<p>Automática: se asigna una dirección Ip al cliente hasta que este se desconecta y la libera, con un tiempo ilimitado.</p>
</li>
</ul>
<p>El rango de direcciones es el intervalo consecutivo de estas, las cuales son válidas y están disponibles para ser asignadas.</p>
<p>De la misma manera que podemos definir una Ip para que se asigne de forma estática, también podemos excluirlas para que no se puedan conceder a nuevas máquinas. Estas suelen ser reservadas para servidores, routers&mldr;</p>
<p>El tiempo de concesión o lease time es el tiempo que un cliente DHCP mantiene sus datos de configuración otorgados por el servidor. Una vez vencido este tiempo, puede solicitar su renovación o una desconexión.</p>
<h2 id=servidores-dhcp-1>Servidores DHCP<a href=#servidores-dhcp-1 class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>Permiten asignar la configuración de red al resto de máquinas presentes en la red cuando estos inician sus interfaces de red. Por defecto, el puerto de escucha es el 67 mediante UDP.</p>
<p>Los parámetros que estos servidores configuran son:</p>
<ul>
<li>
<p>Dirección Ip</p>
</li>
<li>
<p>Máscara de subred</p>
</li>
<li>
<p>Puerta de enlace</p>
</li>
<li>
<p>Servidores DNS</p>
</li>
<li>
<p>Nombre DNS</p>
</li>
</ul>
<p>Algunos de los ejemplos de servidores DHCP son:</p>
<ul>
<li>
<p>ISC DHCP: servidor para Linux</p>
</li>
<li>
<p>Servidor DHCP de Microsoft: principalmente para Windows Server</p>
</li>
<li>
<p>Servidor DHCP integrados en routers: en ocasiones un router particular puede incluir este servicio.</p>
</li>
</ul>
<h2 id=clientes-dhcp>Clientes DHCP<a href=#clientes-dhcp class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>Son los que realizan peticiones al servidor DHCP y configuran sus parámetros con los que reciben del propio servidor. Para estas tareas, utilizan el puerto 68 mediante UDP. Estos clientes vienen integrados por defecto en los sistemas operativos.</p>
<h2 id=tipos-de-opciones>Tipos de opciones<a href=#tipos-de-opciones class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>Los parámetros que el servidor envía a los clientes se pueden establecer a diferentes niveles:</p>
<ul>
<li>
<p>Opciones de servidor: se envían a todos los clientes.</p>
</li>
<li>
<p>Opciones de ámbito: se envían a todos los clientes del ámbito y sobrescriben a los del servidor.</p>
</li>
<li>
<p>Opciones de clase: se envían a los clientes de pendiendo de a que clase pertenecen.</p>
</li>
<li>
<p>Opciones de equipo: se define para un equipo concreto mediante una reserva. Este tipo de configuración sobrescribe a todas las demás.</p>
</li>
</ul>
<h2 id=protocolo-dhcp>Protocolo DHCP<a href=#protocolo-dhcp class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>Determina el conjunto de normas y reglas en base a las cuales dialogan os clientes y servidores.</p>
<p>El formato de un mensaje DHCP tiene una parte fija que aparece en todos los mensajes, aunque irá cambiando conforme se obtengan opciones específicas.</p>
<h2 id=funcionamiento>Funcionamiento<a href=#funcionamiento class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>Los pasos que sigue el servicio DHCP son los siguientes:</p>
<ol>
<li>
<p>Un cliente DHCP envía una solicitud en forma de broadcast a través de la red para solicitar una configuración.</p>
</li>
<li>
<p>Todos los servidores alcanzados por la solicitud responden al cliente.</p>
</li>
<li>
<p>El cliente acepta una de estas, haciéndoselo saber al servidor elegido.</p>
</li>
<li>
<p>El servidor le otorga la información requerida.</p>
</li>
<li>
<p>Esta información se mantiene asociada al cliente mientras éste no desactive su interfaz o no expire el plazo de concesión.</p>
</li>
<li>
<p>Cuando expira el plazo, el cliente puede pedir una renovación.</p>
</li>
</ol>
<h3 id=obtención-de-una-concesión>Obtención de una concesión<a href=#obtención-de-una-concesión class=hanchor arialabel=Anchor>&#8983;</a> </h3>
<p>Sigue los siguientes pasos:</p>
<ol>
<li>
<p>Descubrimiento DHCP ( DHCPDISCOVER ): el cliente manda la señal de broadcast desde el puerto 68 a todos los puertos 67, que serán donde los servidores escuchen.</p>
</li>
<li>
<p>Oferta DHCP ( DHCPOFFER ): los servidores responden al puerto 68 del cliente, enviándole una ip y algunos parámetros de configuración. Durante este paso, la dirección ip enviada se reserva.</p>
</li>
<li>
<p>Solicitud DHCP ( DHCPREQUEST ): el cliente recibe una o más ofertas de servidores y elige la que mejor funcione y envía un mensaje DHCPREQUEST poniendo como destino al servidor elegido. En caso de no recibir la respuesta con DHCPOFFER, reenvía un nuevo mensaje.</p>
</li>
<li>
<p>Reconocimiento DHCP ( DHCPACK ): Si el mensaje DHCPREQUEST no contiene su dirección, el servidor la considera rechazada, en caso de que sea correcta y la Ip siga disponible, el servidor enviará un mensaje DHCPACK, en caso de no estarlo, se enviará un mensaje DHCPNACK.</p>
</li>
</ol>
<p>Los clientes, normalmente intentan renovar su concesión:</p>
<ul>
<li>
<p>Cuando inician su interfaz, para asegurarse de poder usar la dirección Ip anteriormente otorgada, y si no pueden, solicitar una nueva.</p>
</li>
<li>
<p>Antes de que finalice el periodo de concesión, para garantizar que la información de configuración quede actualizada.</p>
</li>
<li>
<p>Manualmente desde el cliente en cualquier otro momento</p>
</li>
</ul>
<p>El cliente puede elegir abandonar su alquiler de una dirección enviando el mensaje DHCPRELEASE al servidor.</p>
<p>Se pueden actualizar los parámetros de configuración cuando el cliente contacta con el servidor para cualquier acción de todas las anteriores.</p>
<h2 id=mensajes-dhcp>Mensajes DHCP<a href=#mensajes-dhcp class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>Tenemos principalmente 8 mensajes diferentes:</p>
<ol>
<li>
<p>DHCPDISCOVER: mensaje que envía el cliente a la red para solicitar unirse a un servidor.</p>
</li>
<li>
<p>DHCPOFFER: mensaje que envía el servidor como respuesta al cliente que la ha solicitado.</p>
</li>
<li>
<p>DHCPREQUEST: mensaje que envía el cliente como respuesta a la oferta que le ha realizado un servidor.</p>
</li>
<li>
<p>DHCPACK: mensaje de confirmación y cierre desde el servidor hacia el cliente indicándole los parámetros definitivos.</p>
</li>
<li>
<p>DHCPNACK: mensaje que informa desde el servidor al cliente de que la Ip solicitada no es válida, o la configuración incluye algún error.</p>
</li>
<li>
<p>DHCPDECLINE: el cliente informa al servidor de que la dirección está en uso.</p>
</li>
<li>
<p>DHCPRELEASE: el cliente informa al servidor de que ha finalizado su uso con la Ip.</p>
</li>
<li>
<p>DHCPINFORM: el cliente consulta al servidor la configuración local.</p>
</li>
</ol>
<h2 id=configuración-de-varios-servidores>Configuración de varios servidores<a href=#configuración-de-varios-servidores class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>Un servidor DHCP debe estar en la misma red física que los clientes. Si se dispone de varias redes para conectar, tenemos diferentes opciones:</p>
<ol>
<li>
<p>Configurar un servidor DHCP en cada subred: esta opción supone un aumento del trabajo administrativo y del equipo necesario, ya que habrá que ubicar un servidor DHCP en cada subred individual.</p>
</li>
<li>
<p>Configurar un servidor DHCP desde una ubicación centralizada a varias subredes: en este caso se pueden contemplar varias opciones</p>
<ol>
<li>
<p>Conectar el servidor directamente a las diferentes redes</p>
</li>
<li>
<p>Que los enrutadores tengan capacidad de retransmitir mensajes DHCP entre redes</p>
</li>
<li>
<p>Instalar un agente de retransmisión DHCP en algún equipo y configurarlo para escuchar los mensajes y redirigirlos a un servidor DHCP específico.</p>
</li>
</ol>
</li>
</ol>
<h2 id=agente-de-retransmisión-dhcp>Agente de retransmisión DHCP<a href=#agente-de-retransmisión-dhcp class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>Se trata de un equipo o enrutador configurado para escuchar difusiones DHCP procedentes de clientes, y a continuación, retransmitir dichos mensajes a los servidores.</p>
<p>Los tipos de agentes de retransmisión DHCP pueden ser:</p>
<ul>
<li>
<p>Integrados en routers</p>
</li>
<li>
<p>Servidor que funcione como agente de retransmisión</p>
</li>
</ul>
<p>Para que un servidor funcione como agente de retransmisión, el funcionamiento debe ser el siguiente.</p>
<ol>
<li>
<p>El cliente difunde un mensaje DHCPDISCOVER</p>
</li>
<li>
<p>El agente de retransmisión de la subred del cliente reenvía el mensaje al servidor mediante unidifusión.</p>
</li>
<li>
<p>El servidor emplea unidifusión para enviar el mensaje de DHCPOFFER al agente.</p>
</li>
<li>
<p>El agente de retransmisión difunde el DHCPOFFER a la subred del cliente.</p>
</li>
<li>
<p>El cliente difunde el mensaje DHCPREQUEST</p>
</li>
<li>
<p>El agente de retransmisión recoge el mensaje y se lo envía al servidor mediante unidifusión.</p>
</li>
<li>
<p>El servidor genera el mensaje DHCPACK, que se le envía de nuevo al agente.</p>
</li>
<li>
<p>Finalmente el agente envía este último mensaje a la subred del cliente.</p>
</li>
</ol>
<p>El servidor DHCP dará la configuración dará una configuración de red adecuada al segmento de red al que está conectado el equipo que efectúa la petición.</p>
<h1 id=protocolo-de-failover-en-dhcp>Protocolo de failover en DHCP<a href=#protocolo-de-failover-en-dhcp class=hanchor arialabel=Anchor>&#8983;</a> </h1>
<p>Cuando 2 servidores DHCP se encuentran en la misma red, ambos mantienen una base de datos con sus concesiones y sus estados. Para evitar que la misma dirección Ip se asigne a varios equipos, la solución es que estos trabajen con distintos rangos de direcciones.</p>
<p>Si ambos servidores desean trabajar con el mismo rango de direcciones, es necesario que sus bases de datos estén sincronizadas. Para esto se utiliza el protocolo Failover entre 2 servidores DHCP.</p>
<p>Este protocolo también se puede utilizar para realizar un balanceo de carga, de manera que el trabajo se reparta entre los servidores primario y secundario.</p>
</div></div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button next">
<a href=https://lordantonio99.github.io/hugo-terminal/posts/servidordnsmasq/>
<span class=button__text>Servidordnsmasq</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class=copyright>
<span>© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span>
</div>
</div>
</footer>
<script src=https://lordantonio99.github.io/hugo-terminal/assets/main.js></script>
<script src=https://lordantonio99.github.io/hugo-terminal/assets/prism.js></script>
</div>
</body>
</html>